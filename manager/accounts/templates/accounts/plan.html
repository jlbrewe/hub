{% extends './base.html' %}
{% load i18n stencila humanize %}

{% block title %}{{ account.name }} {% trans "Plan" %}{% endblock %}

{% block accounts_content %}

<h2 class="title">Usage</h2>

<div class="columns">
  <div class="column pb-0">
    <h3 class="title is-4">
      <span class="icon">
        <i class="ri-book-2-line"></i>
      </span>
      <span>
        {{ fields.projects_private.verbose_name }}
      </span>
    </h3>

    <p class="subtitle mb-2">
      <span class="has-text-weight-normal">
        {{ usage.projects_private.amount }} of {{ usage.projects_private.limit }}
      </span>

      <span class="icon has-text-grey has-tooltip-bottom has-tooltip-text-centered is-vcentered"
        data-tooltip="{{ fields.projects_private.help_text }}">
        <i class="ri-question-line"></i>
      </span>
    </p>

    <div>
      <progress class="progress is-vcentered is-primary" value="{{ usage.projects_private.amount }}"
        max="{{ usage.projects_private.limit }}">
        {{ usage.projects_private.percent }}%
      </progress>
    </div>
  </div>

  <div class="column pb-0">
    <h3 class="title is-4">
      <span class="icon">
        <i class="ri-database-2-line"></i>
      </span>
      <span>
        {{ fields.storage_working.verbose_name }}
      </span>
    </h3>

    <p class="subtitle mb-2">
      <span class="has-text-weight-normal">
        {{ usage.storage_working.amount|floatformat:3 }}GB of {{ usage.storage_working.limit }}GB
      </span>

      <span class="icon has-text-grey has-tooltip-bottom has-tooltip-text-centered is-vcentered"
        data-tooltip="{{ fields.storage_working.help_text }}">
        <i class="ri-question-line"></i>
      </span>
    </p>

    <div>
      <progress class="progress is-vcentered is-primary" value="{{ usage.storage_working.amount }}"
                                                         max="{{ usage.storage_working.limit }}">
        {{ usage.storage_working.percent }}%
      </progress>
    </div>
  </div>

  <div class="column pb-0">
    <h3 class="title is-4">
      <span class="icon">
        <i class="ri-download-cloud-2-line"></i>
      </span>
      <span>
        {{ fields.file_downloads_month.verbose_name }}
      </span>
    </h3>

    <p class="subtitle mb-2">
      <span class="has-text-weight-normal">
        {{ usage.file_downloads_month.amount|floatformat:3 }}GB of {{ usage.file_downloads_month.limit }}GB
      </span>

      <span class="icon has-text-grey has-tooltip-bottom has-tooltip-text-centered is-vcentered"
            data-tooltip="{{ fields.file_downloads_month.help_text }}">
        <i class="ri-question-line"></i>
      </span>
    </p>

    <div>
      <progress class="progress is-vcentered is-primary" value="{{ usage.file_downloads_month.amount }}"
                                                         max="{{ usage.file_downloads_month.limit }}">
        {{ usage.file_downloads_month.percent }}%
      </progress>
    </div>
  </div>

  <div class="column pb-0">
    <h3 class="title is-4">
      <span class="icon">
        <i class="ri-timer-2-line"></i>
      </span>
      <span>
        {{ fields.job_runtime_month.verbose_name }}
      </span>
    </h3>

    <p class="subtitle mb-2">
      <span class="has-text-weight-normal">
        {{ usage.job_runtime_month.amount|floatformat:1 }}mins of {{ usage.job_runtime_month.limit }}mins
      </span>

      <span class="icon has-text-grey has-tooltip-bottom has-tooltip-text-centered is-vcentered"
            data-tooltip="{{ fields.job_runtime_month.help_text }}">
        <i class="ri-question-line"></i>
      </span>
    </p>

    <div>
      <progress class="progress is-vcentered is-primary" value="{{ usage.job_runtime_month.amount }}"
                                                         max="{{ usage.job_runtime_month.limit }}">
        {{ usage.job_runtime_month.percent }}%
      </progress>
    </div>
  </div>
</div>

<hr />

<h2 class="title">Plans<h2>

    <div class="message is-info">
      <p class="message-header">
        <span class="icon"><i class="ri-broadcast-line"></i></span>
        <span>Higher limits and more plans soon!</span>
      </p>
      <p class="message-body">
        While we are still in development, there are only two plans:
        a "Waiting List" plan (which does not let you do much) and a "Team" plan
        (for our beta-testers to test things out with).
        Stay tuned for more plans and higher limits soon. We'll be moving
        you off the waiting list when things are more stable.
      </p>
    </div>

    <ul class="columns is-multiline is-variable is-2 pricing-table mt-4">
      {% for tier in tiers %}
      {% if tier.active %}
      <li class="column is-one-third pb-0">
        <figure class="is-size-5 pricing-table__item">
          <h2 class="has-text-centered title is-4">{% trans tier.name %}</h2>

          <p>
            <span class="icon has-text-grey-light"><i class="ri-lock-line"></i></span>
            <span>
              {{ tier.projects_private }} {% trans "Private projects" %}
            </span>
          </p>

          <p>
            <span class="icon has-text-grey-light"><i class="ri-global-line"></i></span>
            <span>
              {{ tier.projects_public }} {% trans "Public projects" %}
            </span>
          </p>

          {% if account.is_organization %}
          <p>
            <span class="icon has-text-grey-light"><i class="ri-user-line"></i></span>
            <span>
              {{ tier.account_users }} {% trans "Users" %}
            </span>
          </p>

          <p>
            <span class="icon has-text-grey-light"><i class="ri-group-line"></i></span>
            <span>
              {{ tier.account_teams }} {% trans "Teams" %}
            </span>
          </p>
          {% endif %}

          <p>
            <span class="icon has-text-grey-light"><i class="ri-database-2-line"></i></span>
            <span>
              {{ tier.storage_working }}GB {% trans "Project storage" %}
            </span>
          </p>

          <p>
            <span class="icon has-text-grey-light"><i class="ri-archive-line"></i></span>
            <span>
              {{ tier.storage_snapshots }}GB {% trans "Snapshot storage" %}
            </span>
            <span class="icon has-text-grey-light has-tooltip-bottom has-tooltip-text-centered"
                  data-tooltip="{% trans "Snapshots are versioned archives of a project" %}">
              <i class="ri-question-line"></i>
            </span>
          </p>

          <p>
            <span class="icon has-text-grey-light"><i class="ri-timer-line"></i></span>
            <span>
              {{ tier.job_runtime_month|intcomma }} {% trans "Job minutes" %}
            </span>
            <span class="icon has-text-grey-light has-tooltip-bottom has-tooltip-text-centered"
                  data-tooltip="{% trans fields.job_runtime_month.help_text %}">
              <i class="ri-question-line"></i>
            </span>
          </p>

          <button class="button is-fullwidth is-primary mt-4" has-tooltip-bottom has-tooltip-text-centered image-tooltip
                  data-tooltip="{% trans 'Coming soon!' %}" disabled
                  {% if tier.id == account.tier.id %}disabled{% endif %}>
            {% if tier.id == account.tier_id %}
            Your current plan
            {% else %}
            Switch to {{ tier.name }}
            {% endif %}
          </button>
        </figure>
      </li>
      {% endif %}
      {% endfor %}
    </ul>

    {% endblock %}
